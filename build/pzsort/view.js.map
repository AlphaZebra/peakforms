{"version":3,"file":"pzsort/view.js","mappings":";;;;AAAAA,QAAQ,CAACC,gBAAgB,CAAC,kBAAkB,EAAE,YAAY;EACzD,IAAIC,KAAK,GAAGF,QAAQ,CAACG,gBAAgB,CAAC,kBAAkB,CAAC;EAEzDD,KAAK,CAACE,OAAO,CAAEC,IAAI,IAAK;IACvBA,IAAI,CAACC,SAAS,GAAG,IAAI;IACrBD,IAAI,CAACJ,gBAAgB,CAAC,WAAW,EAAEM,SAAS,CAAC;IAC7CF,IAAI,CAACJ,gBAAgB,CAAC,MAAM,EAAEO,OAAO,CAAC;IACtCH,IAAI,CAACJ,gBAAgB,CAAC,WAAW,EAAEQ,aAAa,CAAC;IACjDJ,IAAI,CAACJ,gBAAgB,CAAC,UAAU,EAAEQ,aAAa,CAAC;EACjD,CAAC,CAAC;EAEF,SAASF,SAASA,CAACG,CAAC,EAAE;IACrB;IACA,IAAIR,KAAK,GAAGS,KAAK,CAACC,IAAI,CAACF,CAAC,CAACG,MAAM,CAACC,UAAU,CAACC,QAAQ,CAAC;IACpD,IAAIC,KAAK,GAAGd,KAAK,CAACe,OAAO,CAACP,CAAC,CAACG,MAAM,CAAC;IACnCH,CAAC,CAACQ,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEH,KAAK,CAAC;EAC5C;EAEA,SAASR,OAAOA,CAACE,CAAC,EAAE;IACnBD,aAAa,CAACC,CAAC,CAAC;;IAEhB;IACA,IAAIU,QAAQ,GAAGC,QAAQ,CAACX,CAAC,CAACQ,YAAY,CAACI,OAAO,CAAC,YAAY,CAAC,CAAC;IAC7D,IAAIpB,KAAK,GAAGF,QAAQ,CAACG,gBAAgB,CAAC,kBAAkB,CAAC;IACzD,IAAIoB,WAAW,GAAGrB,KAAK,CAACkB,QAAQ,CAAC;;IAEjC;IACAG,WAAW,CAACT,UAAU,CAACU,WAAW,CAACD,WAAW,CAAC;;IAE/C;IACA,IAAIb,CAAC,CAACe,OAAO,GAAGf,CAAC,CAACG,MAAM,CAACa,YAAY,GAAG,CAAC,EAAE;MAC1ChB,CAAC,CAACG,MAAM,CAACC,UAAU,CAACa,YAAY,CAACJ,WAAW,EAAEb,CAAC,CAACG,MAAM,CAAC;IACxD,CAAC,MAAM;MACNH,CAAC,CAACG,MAAM,CAACC,UAAU,CAACa,YAAY,CAACJ,WAAW,EAAEb,CAAC,CAACG,MAAM,CAACe,WAAW,CAAC;IACpE;EACD;EAEA,SAASnB,aAAaA,CAACC,CAAC,EAAE;IACzBA,CAAC,CAACmB,cAAc,CAAC,CAAC;IAClBnB,CAAC,CAACoB,eAAe,CAAC,CAAC;IACnB,OAAO,KAAK;EACb;;EAEA;;EAEA,MAAMC,IAAI,GAAG/B,QAAQ,CAACgC,aAAa,CAAC,kCAAkC,CAAC;EACvE,MAAMC,SAAS,GAAGjC,QAAQ,CAACgC,aAAa,CAAC,aAAa,CAAC;EACvD,MAAME,SAAS,GAAGD,SAAS,CAACE,OAAO,CAACC,IAAI,IAAI,cAAc,CAAC,CAAC;;EAE5D,IAAIL,IAAI,EAAE;IACTA,IAAI,CAAC9B,gBAAgB,CAAC,QAAQ,EAAE,UAAUS,CAAC,EAAE;MAC5CA,CAAC,CAACmB,cAAc,CAAC,CAAC;MAElB,MAAMQ,WAAW,GAAG1B,KAAK,CAACC,IAAI,CAACqB,SAAS,CAAClB,QAAQ,CAAC,CAACuB,GAAG,CAAEjC,IAAI,IAAK;QAChE,OAAOA,IAAI,CAACkC,WAAW,CACrBC,IAAI,CAAC,CAAC,CACNC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CACtBA,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC;MACvB,CAAC,CAAC;MAEF,MAAMC,WAAW,GAAG1C,QAAQ,CAAC2C,aAAa,CAAC,OAAO,CAAC;MACnDD,WAAW,CAACE,IAAI,GAAG,QAAQ;MAC3BF,WAAW,CAACG,IAAI,GAAGX,SAAS;MAC5BQ,WAAW,CAACI,KAAK,GAAGC,IAAI,CAACC,SAAS,CAACX,WAAW,CAAC;MAE/C,MAAMY,aAAa,GAAGlB,IAAI,CAACC,aAAa,CAAC,eAAeE,SAAS,IAAI,CAAC;MACtE,IAAIe,aAAa,EAAE;QAClBA,aAAa,CAACC,MAAM,CAAC,CAAC;MACvB;MAEAnB,IAAI,CAACoB,WAAW,CAACT,WAAW,CAAC;MAC7BX,IAAI,CAACqB,MAAM,CAAC,CAAC;IACd,CAAC,CAAC;EACH,CAAC,MAAM;IACNC,OAAO,CAACC,KAAK,CAAC,iBAAiB,CAAC;EACjC;AACD,CAAC,CAAC,C","sources":["webpack://pzforms/./src/pzsort/view.js"],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", function () {\r\n\tlet items = document.querySelectorAll(\"#items-list > li\");\r\n\r\n\titems.forEach((item) => {\r\n\t\titem.draggable = true;\r\n\t\titem.addEventListener(\"dragstart\", dragStart);\r\n\t\titem.addEventListener(\"drop\", dropped);\r\n\t\titem.addEventListener(\"dragenter\", cancelDefault);\r\n\t\titem.addEventListener(\"dragover\", cancelDefault);\r\n\t});\r\n\r\n\tfunction dragStart(e) {\r\n\t\t// Get the index of the dragged item relative to its siblings\r\n\t\tlet items = Array.from(e.target.parentNode.children);\r\n\t\tlet index = items.indexOf(e.target);\r\n\t\te.dataTransfer.setData(\"text/plain\", index);\r\n\t}\r\n\r\n\tfunction dropped(e) {\r\n\t\tcancelDefault(e);\r\n\r\n\t\t// Get the dragged item's index from the dataTransfer\r\n\t\tlet oldIndex = parseInt(e.dataTransfer.getData(\"text/plain\"));\r\n\t\tlet items = document.querySelectorAll(\"#items-list > li\");\r\n\t\tlet draggedItem = items[oldIndex];\r\n\r\n\t\t// Remove the dragged item from its original position\r\n\t\tdraggedItem.parentNode.removeChild(draggedItem);\r\n\r\n\t\t// Insert before or after the drop target based on position\r\n\t\tif (e.offsetY < e.target.offsetHeight / 2) {\r\n\t\t\te.target.parentNode.insertBefore(draggedItem, e.target);\r\n\t\t} else {\r\n\t\t\te.target.parentNode.insertBefore(draggedItem, e.target.nextSibling);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction cancelDefault(e) {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// This is to save the sorted items to the form\r\n\r\n\tconst form = document.querySelector('form:has(input[name=\"formName\"])');\r\n\tconst itemsList = document.querySelector(\"#items-list\");\r\n\tconst fieldName = itemsList.dataset.slug || \"sorted_items\"; // Fallback if slug not set\r\n\r\n\tif (form) {\r\n\t\tform.addEventListener(\"submit\", function (e) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst sortedItems = Array.from(itemsList.children).map((item) => {\r\n\t\t\t\treturn item.textContent\r\n\t\t\t\t\t.trim()\r\n\t\t\t\t\t.replace(/\\\\/g, \"\\\\\\\\\")\r\n\t\t\t\t\t.replace(/\"/g, '\\\\\"');\r\n\t\t\t});\r\n\r\n\t\t\tconst hiddenInput = document.createElement(\"input\");\r\n\t\t\thiddenInput.type = \"hidden\";\r\n\t\t\thiddenInput.name = fieldName;\r\n\t\t\thiddenInput.value = JSON.stringify(sortedItems);\r\n\r\n\t\t\tconst existingInput = form.querySelector(`input[name=\"${fieldName}\"]`);\r\n\t\t\tif (existingInput) {\r\n\t\t\t\texistingInput.remove();\r\n\t\t\t}\r\n\r\n\t\t\tform.appendChild(hiddenInput);\r\n\t\t\tform.submit();\r\n\t\t});\r\n\t} else {\r\n\t\tconsole.error(\"Form not found!\");\r\n\t}\r\n});\r\n"],"names":["document","addEventListener","items","querySelectorAll","forEach","item","draggable","dragStart","dropped","cancelDefault","e","Array","from","target","parentNode","children","index","indexOf","dataTransfer","setData","oldIndex","parseInt","getData","draggedItem","removeChild","offsetY","offsetHeight","insertBefore","nextSibling","preventDefault","stopPropagation","form","querySelector","itemsList","fieldName","dataset","slug","sortedItems","map","textContent","trim","replace","hiddenInput","createElement","type","name","value","JSON","stringify","existingInput","remove","appendChild","submit","console","error"],"sourceRoot":""}